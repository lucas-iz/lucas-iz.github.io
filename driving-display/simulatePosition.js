let currentIndex = 0;
let interval = null;

function simulateGPS(path, intervalMs = 2000) {
  navigator.geolocation.getCurrentPosition = function (success, error) {
    success({
      coords: {
        latitude: path[currentIndex].latitude,
        longitude: path[currentIndex].longitude,
        accuracy: 5,
      },
      timestamp: Date.now(),
    });
  };

  navigator.geolocation.watchPosition = function (success, error) {
    interval = setInterval(() => {
      if (currentIndex >= path.length) currentIndex = 0;
      success({
        coords: {
          latitude: path[currentIndex].latitude,
          longitude: path[currentIndex].longitude,
          accuracy: 5,
        },
        timestamp: Date.now(),
      });
      currentIndex++;
      console.log("Simulating GPS position updates...");
    }, intervalMs);
  };
}

const geodata = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "MultiLineString",
        coordinates: [
          [
            [7.834609254781021, 52.78419783930247, 92.9001578863759],
            [7.834607627183855, 52.78420089294296, 93.81589107640008],
            [7.834589685213832, 52.784210337244154, 94.09235740053205],
            [7.8346420644170145, 52.78422177236303, 94.11250287310072],
            [7.834652429388825, 52.78422563870681, 93.18141647732193],
            [7.834673578954254, 52.78423281158438, 92.30167183019073],
            [7.834679889968909, 52.78423383870536, 90.3551771642769],
            [7.834675337914574, 52.78423296366852, 89.79415294618654],
            [7.834686868070264, 52.78423607057652, 88.9010499131459],
            [7.83469254524888, 52.78423848020329, 88.31423826232897],
            [7.834689866754335, 52.78423888321266, 87.861905558281],
            [7.83468980302468, 52.78423592156999, 86.43589537125618],
            [7.834688265481094, 52.78422828270546, 86.2512586923316],
            [7.834688942288747, 52.78422427591951, 86.21090920348917],
            [7.834694611289782, 52.78422566896644, 85.96969563947842],
            [7.834672550915688, 52.784227395652124, 86.06726563485951],
            [7.8346711874108, 52.78422475882693, 86.6457464723335],
            [7.834669226875013, 52.78422326986936, 86.87731299081808],
            [7.834663740083377, 52.78422106957109, 86.81992457402986],
            [7.834660271692482, 52.78422041037464, 86.3353050189327],
            [7.834650473028043, 52.784216336491774, 86.56376257242518],
            [7.834643017361855, 52.78421503598122, 85.65027990732088],
            [7.834637803172686, 52.78421244230233, 84.9835107554145],
            [7.83464372460046, 52.784210246719255, 85.16188942178384],
            [7.834632638239524, 52.784211719708054, 85.16735058410602],
            [7.834629191373244, 52.784212369335, 85.46708108432784],
            [7.834640098089412, 52.78421639069987, 85.39942856066237],
            [7.834642486252654, 52.78421494361726, 85.1297383725985],
            [7.834636517016692, 52.78421202772383, 84.85807704621652],
            [7.834641185252896, 52.784207307613585, 84.68555829359231],
            [7.834645445675129, 52.784205412170316, 84.76910487138449],
            [7.8346454328838835, 52.784204984006756, 84.50721335916205],
            [7.834659259654492, 52.784201252320436, 84.49906662095948],
            [7.834684386665781, 52.78421049092165, 84.75279393203662],
            [7.834683781784389, 52.78421072217439, 84.96523652753582],
            [7.834687026057563, 52.78421387667929, 85.37761816535065],
            [7.834690832857452, 52.78421585194649, 85.59106722597598],
            [7.834688347452062, 52.7842176591593, 85.98897911384792],
            [7.83469139407124, 52.78421762363284, 85.69271976685164],
            [7.834694943312514, 52.784219804408345, 85.36943780522962],
            [7.834697220115572, 52.78421758102457, 84.82880310478008],
            [7.834693590277274, 52.78421618490321, 84.50656086146635],
            [7.834694039532028, 52.784212919835475, 84.77495740799256],
            [7.834692320578301, 52.7842067492999, 84.79706942055198],
            [7.834680145557188, 52.784203861141286, 84.52227990224839],
            [7.834672069226427, 52.78420109030837, 84.07198705202948],
            [7.834665409706765, 52.78419860738607, 84.07710653828453],
            [7.834662339695752, 52.78418485952638, 84.62204246018734],
            [7.834670679490156, 52.78417552217389, 85.2991455749061],
            [7.834665908810696, 52.78417588168231, 85.64528351144916],
            [7.834653874284307, 52.7841798705234, 85.79275018255663],
            [7.834655497178747, 52.784182779857495, 85.73512700411524],
            [7.834658409868915, 52.784186959447865, 85.44277422125738],
            [7.834340254979368, 52.78408121267369, 82.99968966358692],
            [7.833871362339802, 52.783848890014035, 81.92046023154978],
            [7.8331792856966675, 52.78346026989239, 81.79657590263122],
            [7.832607188685106, 52.78299729624306, 86.0127013989994],
            [7.831332781921582, 52.78234305769311, 85.01825929304223],
            [7.8295387874053874, 52.781409427020485, 84.80424563910827],
            [7.8273836001071535, 52.780303906137256, 85.78694853650036],
            [7.825232018096019, 52.77920840670186, 89.15529171562738],
            [7.822928511748063, 52.77806636108441, 90.8168963108071],
            [7.8206917040753225, 52.77691300039802, 87.38258869039332],
            [7.818557226690671, 52.775790321404, 84.29446154550442],
            [7.816435487945432, 52.774698983475695, 81.95231359818663],
            [7.81424096507207, 52.77356660286411, 80.38623623539226],
            [7.811964079567679, 52.77239771378641, 79.49768164852007],
            [7.809750006880421, 52.77128470009465, 77.59510528165734],
            [7.80756381037399, 52.7701595682077, 77.26498023586272],
            [7.805378719951737, 52.76904518543587, 77.27431098232779],
            [7.803189285341918, 52.76792410086055, 77.58716159441602],
            [7.800999424070349, 52.7667986946216, 78.19051013096416],
            [7.79880346803336, 52.765675379738695, 78.62833965502921],
            [7.796613389653836, 52.764544235406305, 79.76020844163939],
            [7.794459277842423, 52.76342431095225, 78.236165967802],
            [7.792255144077244, 52.76230467300913, 78.45723683309107],
            [7.790061477518759, 52.76118340567574, 78.46099180164849],
            [7.787883636381041, 52.76008358935262, 77.71288605039865],
            [7.785509524763122, 52.75885665476058, 76.0937804071378],
            [7.783317694993468, 52.7577550099584, 75.94530277149546],
            [7.781129918523948, 52.7565939310843, 72.52404101628494],
            [7.7789389641997015, 52.75547634539087, 72.37852532662676],
            [7.776741860660893, 52.7543791069431, 76.51671107353545],
            [7.774589110774633, 52.75324458547996, 78.34991475310437],
            [7.772372348382097, 52.75212776111057, 77.91726733909879],
            [7.770181096935724, 52.7510303188969, 78.40119747332241],
            [7.76800880100868, 52.7499078678663, 79.89581822976824],
            [7.765814135467387, 52.74878951893816, 80.4480912544805],
            [7.763623420466548, 52.74767405880386, 82.13714373185474],
            [7.761449630476858, 52.74654194245107, 84.41977474198298],
            [7.759252945115417, 52.74543126375368, 86.5938248680139],
            [7.756903382781852, 52.744320270038166, 88.0863513545745],
            [7.754386886157001, 52.743239635715106, 88.50906445448909],
            [7.751838469787526, 52.742169027498605, 86.31866700416333],
            [7.749331305437068, 52.74107184784116, 83.90598048096821],
            [7.746931218979242, 52.7399020065302, 81.41008512463522],
            [7.744636180554134, 52.738656318772364, 80.17817068274643],
            [7.742445258253753, 52.737340345086594, 79.29692796891065],
            [7.740376194052113, 52.73594801594868, 78.73318650515712],
            [7.738373773859201, 52.73452066299122, 77.9772209972072],
            [7.736238091150647, 52.73322167170757, 77.30548834774004],
            [7.73390478495684, 52.73222994221629, 75.61951538613343],
            [7.73136817804717, 52.73156988909865, 72.51098507544995],
            [7.728407706208386, 52.73106364496434, 71.63283884142676],
            [7.725443212821829, 52.730672221804255, 74.42144637216208],
            [7.722426833708699, 52.73025184989504, 75.46163759985988],
            [7.7194112273538105, 52.729847545891396, 76.0067954236083],
            [7.716408750086824, 52.729459627242896, 75.1275743077695],
            [7.713401295769882, 52.729041913766686, 76.4031920574429],
            [7.710402693009427, 52.72863079505253, 75.98901586260004],
            [7.707391037820969, 52.72822699562248, 76.6451103868814],
            [7.7044590173360445, 52.72771316222435, 76.9289499803184],
            [7.701730160639887, 52.727052311748764, 76.8334548631268],
            [7.699171293195971, 52.7264143691843, 76.46793507255755],
            [7.696811254742963, 52.7258301770481, 76.31846151669184],
            [7.694621129168411, 52.72531212985749, 76.58948654813113],
            [7.6925673317081795, 52.72518352909124, 78.90053623789832],
            [7.690550691579385, 52.72504226197305, 80.22571124190164],
            [7.68845130832918, 52.72458574214049, 78.34702282081611],
            [7.6861368343387255, 52.724167290424255, 75.04096987545702],
            [7.683409278936924, 52.72364875019708, 74.61954772257617],
            [7.680409526571849, 52.723165183568014, 76.13186506911765],
          ],
        ],
      },
      properties: {},
    },
  ],
};

const path = geodata.features[0].geometry.coordinates[0].map((coord) => ({
  latitude: coord[1],
  longitude: coord[0],
}));

simulateGPS(path, 1000); // update every second

// navigator.geolocation.watchPosition(
//   (position) => {
//     console.log(
//       `Latitude: ${position.coords.latitude}, Longitude: ${position.coords.longitude}`
//     );
//   },
//   (error) => {
//     console.error(`Error occurred: ${error.message}`);
//   },
//   {
//     enableHighAccuracy: true,
//     maximumAge: 0,
//     timeout: 5000,
//   }
// );
